# Arbiter
This is a recursive resolver aiming to perform DNSSEC validation as according to the protocol specified in my thesis, "Blockchain Backed DNSSEC".

## Dependencies
- ldns
- mysql
- openssl

## Resolver
The project is built as follows:

- `make main` will build the resolver, which can be run with `./bin/main`. Note that this is for performing verification based on the protocol described in my thesis. Samples can be seen in the Implementation chapter.

The mySQL table specification is as follows:

```
+--------+--------------+------+-----+---------+-------+
| Field  | Type         | Null | Key | Default | Extra |
+--------+--------------+------+-----+---------+-------+
| domain | varchar(191) | YES  |     | NULL    |       |
| cert   | blob         | YES  |     | NULL    |       |
| ksk    | tinyint(1)   | NO   |     | NULL    |       |
+--------+--------------+------+-----+---------+-------+
```

The domain name is in the format `2LD.TLD.`. The cert should be in PEM format. KSK takes a value 1 or 0, for true or false respectively. A config file `config.conf` should be in the format:

```
username=<username>
password=<password>
dbname=<dbname>
```

Example zonefiles can be found in `examples/zonfiles`. Example certificates with public keys for verifying the RRSIGs can be found in `examples/certs`.

## Utilities
There are a number of utility functions included.

- `./util/gen_dnskey.sh` will create an ECDSA P-256 SHA-256 DNSKEY file. KSK and ZSK can be specified.
- `./util/gen_selfsign.sh` creates a self signing certificate with an ECDSA P-256 SHA-256 curve. A seperate key can also be specified.

## Statistics
Graphing functions are available in `py/`. Run `./py/bootstrap.sh` to set up a virtual environment.

- `make reqsize` will build the DNSSEC statistics creator. `./bin/reqsize` will compile a list of all DNSSEC enabled domains stored in the zonefile specified in the `#define ZONEDATA` and perform requests for the resource record stored in the `#define RR`. The output will be in the format `Domain Name`, `Bytes` and `Algorithm`.
- `./py/graph.py` will generate graphs from the file generated by `./bin/reqsize` as specified by a list of parameters.
- `./py/pie.py` will generate a pie chart showing the distribution of DNSSEC algorithms.

For the thesis, graphs were generated from the net zonefile.
